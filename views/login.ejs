<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>register</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link rel="stylesheet" href="login.css">
</head>

<body>
    <section class="mainSection">
        <div class="container">


            <div class="rowSection">


                <div class="columnF">
                    <div class="divCard">
                        <div class="imgDiv">
                            <img src="login.jpg" alt="Sample photo" class="img-fluid" style="border-top-left-radius: .25rem; border-bottom-left-radius: .25rem;" />
                        </div>
                    </div>
                </div>


                <div class="columnS">
                    <div class="divCard">

                        <div class="allInputDiv">

                            <div class="titleCenter">
                                <h3 class="title">Login form</h3>
                            </div>

                            <form onsubmit="return validatePassword(event)" method="post" action="/login" id="frm">
                                <div class="rowInput">

                                    <div class="form-outline mb-4">
                                        <input type="email" id="email" name="email" class="form-control form-control-lg" placeholder="Email" name="email" required />
                                        <p id="email_valid"></p>

                                    </div>

                                    <div class="form-outline mb-4">
                                        <input type="text" id="password" name="password" class="form-control form-control-lg" placeholder="Password" name="password" required />
                                        <p id="password_lable"></p>

                                        <div class="boxRow">
                                            <div class="passDivRember">
                                                <input type="checkbox">
                                                <label class="" for="form3Example8"> Remember Me </label>

                                            </div>
                                            <div class="passDivForget">
                                                <label class="" for="form3Example8"> <a href="/forget"> Forget Password ? </a></label>

                                            </div>

                                        </div>

                                    </div>


                                    <div class="d-flex justify-content-center pt-3">
                                        <input type="submit" id="submitAll" class="btn btn-warning btn-lg ms-2" value="Login">
                                    </div>
                                    <div class="d-flex justify-content-center pt-3">
                                        <label for="">Don't Have Account ? <a href="/register"> Register Here </a></label>
                                    </div>
                                </div>
                            </form>

                        </div>
                    </div>
                </div>
            </div>
    </section>
</body>

<script>
    var status;

    async function validatePassword(e) {

        var frm = document.getElementById('frm');
        var useremail = document.getElementById("email").value;
        var userPassword = document.getElementById("password").value;
        console.log(userPassword)
        console.log("userEmail", useremail)
        let emailValid = await fetch('http://localhost:8050/validPassword', {
            method: 'post',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                useremail,
                userPassword
            })
        })

        let nameData1 = await emailValid.json();
        status = nameData1.status;
        console.log(status)
        let a = 0;
        flag = true;

        if (nameData1.status == 404) {

            document.getElementById("email_valid").innerHTML = "This email id not register."
            document.getElementById("email_valid").style.color = "red";
            document.getElementById("submitAll").style.pointerEvents = "none";
            console.log('wrong email')
            a = 0;
            flag = false;

        }
        if (nameData1.status == 400) {

            document.getElementById("password_lable").innerHTML = "Password is incorrect.";
            document.getElementById("password_lable").style.color = "red";
            document.getElementById("submitAll").style.pointerEvents = "none";
            console.log('wrong email psw')
            a = 0;
            return false;
        }
        if (nameData1.status == 200) {

            document.getElementById("email_valid").innerHTML = ""
            document.getElementById("password_lable").innerHTML = "";
            document.getElementById("submitAll").style.pointerEvents = "";
            console.log('okkk')
            flag = true;

        }


        // console.log(flag);

        // if (flag == false) {

        //     frm.setAttribute('submit', 'validatePassword(event)');


        // } else {
        //     frm.setAttribute('submit', 'validatePassword(event)');
        //     frm.submit();
        // }

    }


    // function finalValidation() {
    //     console.log(status)
    //     if (status == 404) {

    //         document.getElementById("email_valid").innerHTML = "This email id not register."
    //         document.getElementById("email_valid").style.color = "red";
    //         document.getElementById("submitAll").style.pointerEvents = "none";
    //         console.log('wrong email')
    //         return false;
    //     } else if (status == 400) {

    //         document.getElementById("password_lable").innerHTML = "Password is incorrect.";
    //         document.getElementById("password_lable").style.color = "red";
    //         document.getElementById("submitAll").style.pointerEvents = "none";
    //         console.log('wrong email psw')
    //         return false;

    //     } else if (status == 200) {

    //         document.getElementById("email_valid").innerHTML = ""
    //         document.getElementById("password_lable").innerHTML = "";
    //         document.getElementById("submitAll").style.pointerEvents = "";
    //         console.log('okkk')
    //         return true;
    //     }
    // }
</script>

</html>